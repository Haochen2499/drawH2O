(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["UserInfo"],{"0073":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"base-info"},[a("div",{staticClass:"card"},[a("div",{staticClass:"left"},[e.form.avatar?a("img",{staticClass:"avatar",attrs:{src:e.imgUrl(e.form.avatar)}}):a("img",{staticClass:"avatar",attrs:{src:r("4140")}}),e._m(0),a("input",{attrs:{type:"file",id:"avatar",accept:".jpe, .jpeg, .png"},on:{change:function(t){return e.handleUpload(t)}}})]),a("div",{staticClass:"right"},[a("div",{staticClass:"account-info"},[a("div",{staticClass:"title"},[e.isEditTitle?[a("div",{staticClass:"input-wrap"},[a("Input",{staticStyle:{flex:"1"},attrs:{placeholder:"请输入用户名",maxlength:"20","show-word-limit":""},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}}),a("span",{staticClass:"cancel",on:{click:function(t){e.isEditTitle=!1}}},[e._v("取消")]),a("span",{staticClass:"confirm",on:{click:e.handleEditUserName}},[e._v("确认")])],1)]:[a("p",{staticClass:"title-text"},[e._v(" "+e._s(e._.get(e.userInfo,"userName"))+" "),a("Icon",{attrs:{type:"md-brush"},on:{click:function(t){e.isEditTitle=!0}}})],1)]],2),a("p",{staticClass:"mail"},[e._v(e._s(e.userInfo.email))])])])])])])},n=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"upload-wrap",attrs:{for:"avatar"}},[r("div",{staticClass:"upload-text"},[e._v("上传头像")])])}],s=(r("96cf"),r("1da1")),i=r("5530"),c=r("beb5"),u=r("5250"),o=r("2f62"),l=r("aa30"),f=r("1c1e"),p=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,s,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:"image",console.log(t),t){e.next=4;break}return e.abrupt("return");case 4:a=new FormData,a.append("file",t),e.t0=r,e.next="image"===e.t0?9:11;break;case 9:return n="/api/upload/image",e.abrupt("break",12);case 11:return e.abrupt("break",12);case 12:return e.next=14,f["a"].post(n,a);case 14:if(s=e.sent,0!==s.error_code){e.next=20;break}return l["a"].success("上传成功"),e.abrupt("return",s.data.url);case 20:return l["a"].error(s.error_msg),e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d={name:"UserInfo",components:{Icon:u["a"],Input:c["a"]},data:function(){return{isEditTitle:"",form:{userName:"",avatar:""}}},computed:Object(i["a"])({},Object(o["c"])({userInfo:function(e){return e.userInfo}})),created:function(){this.userInfo&&(this.form.userName=this.userInfo.userName,this.form.avatar=this.userInfo.avatar)},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])({getUserInfo:"getUserInfo"})),{},{handleUpload:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.target.files[0],n=a.size/1024,s=600,!(n>s)){r.next=6;break}return t.$Message.error("文件大小不能大于".concat(s,"KB")),r.abrupt("return");case 6:return r.next=8,p(a);case 8:i=r.sent,console.log(i),i&&(t.form.avatar=i,t.updateAvatar());case 11:case"end":return r.stop()}}),r)})))()},updateAvatar:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f["a"].post("/api/user/update",{avatar:e.form.avatar});case 2:r=t.sent,0===r.error_code&&e.getUserInfo();case 4:case"end":return t.stop()}}),t)})))()},handleEditUserName:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.form.userName){t.next=3;break}return e.$Message.error("用户名不能为空"),t.abrupt("return");case 3:return t.next=5,f["a"].post("/api/user/update",{userName:e.form.userName});case 5:r=t.sent,0===r.error_code&&(e.isEditTitle=!1,e.getUserInfo(),e.$Message.success("更改成功"));case 7:case"end":return t.stop()}}),t)})))()},imgUrl:function(e){var t="";return t+e}})},m=d,v=(r("dadd"),r("2877")),b=Object(v["a"])(m,a,n,!1,null,"987cc544",null);t["default"]=b.exports},cb95:function(e,t,r){},dadd:function(e,t,r){"use strict";var a=r("cb95"),n=r.n(a);n.a}}]);
//# sourceMappingURL=UserInfo.79753042.js.map